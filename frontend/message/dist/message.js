var socket=io("http://hosted.stylerdev.io:3100"),queue=[],sound=document.querySelector(".sound"),container=document.querySelector(".subalert"),usernameEl=document.querySelector(".username"),messageEl=document.querySelector(".message"),resub=document.querySelector(".resub"),resubUsername=document.querySelector(".resub > .username"),sub=document.querySelector(".sub"),subUsername=document.querySelector(".sub > .username"),months=document.querySelector(".months"),displayTime=5e3,ttsTime=2e4,lastTen=[],playing=!1,list=document.getElementsByClassName("content")[0],removeElement=function(e){e.parentNode.removeChild(e)},notify=function(e){if(null!==e&&(queue.push(e),$(sub).show(),$(resub).show()),!playing){playing=!0;var t="http://hosted.stylerdev.io:3100/synthesize?voice=en-US_AllisonVoice&text=",n=new Audio,u=queue[0].message;messageEl.textContent=u,usernameEl.textContent=queue[0].username,queue[0].resub>0?($(sub).hide(),resubUsername.textContent=queue[0].username,months.textContent=queue[0].resub):($(resub).hide(),subUsername.textContent=queue[0].username),queue.shift(),container.classList.add("visible"),setTimeout(function(){n.load(),n.src=t+encodeURIComponent(u),n.onended=function(){setTimeout(function(){playing=!1,queue.length>0&&notify(null)},5e3)},n.play()},1e3),setTimeout(function(){container.classList.remove("visible")},6e3)}};socket.on("subMsg",notify),socket.on("stopSound",function(){sound.stop()});