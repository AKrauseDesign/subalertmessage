var socket=io("http://localhost:3100"),queue=[],sound=document.querySelector(".sound"),container=document.querySelector(".subalert"),usernameEl=container.querySelector(".username"),messageEl=container.querySelector(".message"),displayTime=5e3,lastTen=[],playing=!1,list=document.getElementByClassName("lastTen"),lastTen=function(e){if(null!==e){for(var t=0;t<e.length;t++)lastTen.push(e[t]);lastTen.length>10&&(lastTen.pop(),list.removeChild(list.lastChild));for(var n=0;n<lastTen.length;n++){var s=document.createElement("li"),l="username: "+lastTen[t].username+", message: "+lastTen[t].message+", resub: "+lastTen[t].resub;s.appendChild(l),list.appendChild(s)}}},notify=function(e){if(null!==e&&queue.push(e),!playing){playing=!0;var t="http://text-to-speech-demo.mybluemix.net/synthesize?voice=en-US_AllisonVoice&text=",n=queue[0].message;messageEl.textContent=queue[0].message,usernameEl.textContent=queue[0].username,setTimeout(function(){$(".tts").attr("src",t+encodeURIComponent(n))},2e3),queue.shift(),container.classList.add("visible"),setTimeout(function(){container.classList.remove("visible"),setTimeout(function(){playing=!1,queue.length>0&&notify(null)},3e3)},displayTime)}};socket.on("subMsg",lastTen),socket.on("subMsg",notify),socket.on("stopSound",function(){$(".tts").attr("src","")});