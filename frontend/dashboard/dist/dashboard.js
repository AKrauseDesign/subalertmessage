function sendEvent(s,e,t){var a=new XMLHttpRequest;a.open("GET","http://hosted.stylerdev.io:3200/api/visualboard/"+s+"/"+e+"/"+t),a.send(),console.log("Sent event with mode: "+s+", user: "+e+" and target: "+t)}var socket=io("http://hosted.stylerdev.io:3100"),lastTen=[],list=document.getElementsByClassName("content")[0],soundTiles=document.querySelectorAll(".sound-tile"),subCount=0,resubCount=0,userCount=0,viewerMessages,viewerMsg=function(s){viewerMessages=s.userMessages,$(".button").text(viewerMessages?"Disable Viewer Messages":"Enable Viewer Messages")};$(".button").click(function(){viewerMessages=!viewerMessages,$(".button").text(viewerMessages?"Disable Viewer Messages":"Enable Viewer Messages"),socket.emit("changeSettings",{viewerMessages:viewerMessages})}),$(".tab").click(function(){var s=$(this).attr("data-href"),e=$(this).attr("data-title");$(".tab").removeClass("link-active"),$(this).addClass("link-active"),$(".clear").hide(),$(s).show(),$(".wrapper > h1").text(e)});var getAvatar=function(s){var e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxAPDxAQDxARDhAPDxEQEA8QDA8OEAwVFhQWGBURGBQYHCohGRslJxQUITEiJSkrLi46FyszQD8sNygtLisBCgoKBQUFDgUFDisZExkrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrK//AABEIAHgAeAMBIgACEQEDEQH/xAAbAAEBAAMBAQEAAAAAAAAAAAAAAQIGBwQFA//EADQQAAIBAgIIAgkEAwAAAAAAAAABAgMRBAYFEiExQVFhcSIyFEJSYoGRocHREyNT4UOCsf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwDsQKAICgCApbAYgysLAYgysLAYgtgBAUAQFKABQBAUtgIebHY+lQV6s1G+5b5S7I8OYNMrDpRhaVWS2J7qa9p/g0mrVlOTlOTlJ723dsDZsRm1f46LfWc7X+C/J51myr/FT+cjXwBtmFzZB7KtNw96MtdfLefdwuJp1Y61OSmuj3dGuBzY/bB4udGanTlqtfKXRrigOkkPDobSccTT1l4Zxspwv5XzXRnvAgKAICgCgoAh+eKrqlTlUluhFyfW3A/U+HnGrq4ay9ecU+y2gabicRKrOVSe2U3d9OhgRFAoIABARsD26Hx7w9aM/V3TXOL3/k6L229eZyxnRdA1XPDUW9+ok/hs+wHuBQBAUAUFAENfzrF+jxfKqr/FM2E+fp/CurhqsVterrR7x2gc5uW5gmW4GVxcxuLgW4uY3FwLc6FliLWEpX4pv6s57CLk1GKu5NJLm3sSOpYPDqlThTXqRUe9ltYH6AoAgKAKCgCAoA55mfRfo9a8V+3VblDlF8Ynx7nUdJYGGIpSpz3Pc+MHwkjm+k9HVcNPUqq1/LJeWa5oDzXJcxuLgZXFzG59/L2XJYi1Sp4aPR+Kp0XJdQPXkzRTlL0ia8MNlO680uMuyNzJTpqKUYpRjFWSSskuRkBAUAQoKABQBD8sTXhTi51JKEY75N2SGLxMKMJVKj1YxV2/t3Oaac0zPFzvLwwj5Kd7qPV82B9nS2cJyvHDL9OP8klecuy4Gs1q85vWnKU2+MpNs/G4uBlcXMbluBbn74TF1KMtalOUH7rtfuuJ57i4G56Hzgm1DEpR5VY7v9o8O6NuhJNJpppq6ad01zOPXPvZazBLDS1J3lQk9q3ul7y6c0B0QCElJJp3TV01tTT4lAgKAKCnm0niv0aFWr7EG11fBf8AANHztpZ1av6EX+3Rfit68/6NZLKTbbbu222+be9mNwKCEAyBiAMgYlApTG4uBu+RNLNp4ab8q1qT6etH7m4HIdH4t0atOrHfCSl3XFHXoSUkmtqaTT5pgAUAU1/PVTVwcl7U4R+t/sABzYgAAEAAAAUEAFAAFOs5eqOeEoSe90o/TYAB9AoAH//Z",t=jQuery.Deferred();return $.getJSON("https://api.twitch.tv/kraken/users/"+s+"?&callback=?",function(s){console.log(s.logo),t.resolve(s.logo||e)}),t.promise()},sectionFactory=function(s,e,t,a){getAvatar(s).then(function(A){switch(t){default:console.log("ERROR");break;case"userMsg":userCount++,list.insertAdjacentHTML("afterbegin",'<div class="cart"><div class="img-hold"> <img src="'+A+'"> </div><section class ="message-wrap"><div class ="user-info"> <span class="username">'+s+'</span><span class="type"> (Viewer Message)</span><span class="time">'+moment().format("h:mm:ss a")+'</span></div><p class="message">'+e+"</p></div></div></section></div>"),$("#viewer").text(userCount);break;case"resubMsg":resubCount++,list.insertAdjacentHTML("afterbegin",'<div class="cart"><div class="img-hold"> <img src="'+A+'"> </div><section class ="message-wrap"><div class ="user-info"> <span class="username">'+s+'</span><span class="type"> ('+a+' months)</span><span class="time">'+moment().format("h:mm:ss a")+'</span></div><p class="message">'+e+"</p></div></div></section></div>"),$("#resub").text(resubCount);break;case"subMsg":subCount++,list.insertAdjacentHTML("afterbegin",'<div class="cart"><div class="img-hold"> <img src="'+A+'"> </div><section class ="message-wrap"><div class ="user-info"> <span class="username">'+s+'</span><span class="type"> (New Sub)</span><span class="time">'+moment().format("h:mm:ss a")+'</span></div><p class="message">'+e+"</p></div></div></section></div>"),$("#sub").text(subCount)}})},findLastTen=function(s){null!==s&&(lastTen.unshift(s),lastTen.length>10&&lastTen.pop(),sectionFactory(lastTen[0].username,lastTen[0].message,lastTen[0].type,lastTen[0].resub))},soundTiles=document.querySelectorAll(".sound-tile");$(".sound-tile").click(function(){console.log("Sound tile clicked");var s=$(this).attr("data-name");"guns"===s||"salt"===s||"exorcism"===s||"justdoit"===s||"onfire"===s||"dbz"===s||"nyancat"===s||"doglick"===s?sendEvent("overlay","kkona",s):sendEvent("sound","kkona",s)}),socket.on("message",findLastTen),socket.on("settings",viewerMsg);