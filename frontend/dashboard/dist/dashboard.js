var socket=io("http://localhost:3100"),queue=[],lastTen=[],list=document.getElementsByClassName("content")[0],sectionFactory=function(e,s,t){list.insertAdjacentHTML("afterbegin",'<section id="'+e+'"><span class="number">'+e+'</span><div class="wrap"><span class="title">Username: </span> <span class="username">'+s+'</span> <br> <span class="title">Message: </span> <span class="message">'+t+"</span> </div> </section>")},findLastTen=function(e){lastTen.push(e),lastTen.length>10&&lastTen.pop();for(var s=0;s<lastTen.length;s++)sectionFactory(s+1,lastTen[s].username,lastTen[s].message)},notify=function(e){if(queue.push(e),!playing){playing=!0;var s="http://text-to-speech-demo.mybluemix.net/synthesize?voice=en-US_AllisonVoice&text=",t=queue[0].message;messageEl.textContent=queue[0].message,usernameEl.textContent=queue[0].username,queue.shift(),container.classList.add("visible"),setTimeout(function(){tts.src=s+encodeURIComponent(t),setTimeout(function(){container.classList.remove("visible"),setTimeout(function(){playing=!1,queue.length>0&&notify(null)},3e3)},displayTime-2e3)},2e3)}};socket.on("subMsg",findLastTen),socket.on("subMsg",notify),socket.on("stopSound",function(){tts.stop()});