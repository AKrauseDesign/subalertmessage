var socket=io("http://localhost:3100"),queue=[],sound=document.querySelector(".sound"),container=document.querySelector(".subalert"),usernameEl=container.querySelector(".username"),messageEl=container.querySelector(".message"),displayTime=5e3,lastTen=[],playing=!1,list=document.getElementByClassName("content"),sectionFactory=function(e,t,n){var s=document.createElement("section");s.className=e;var a=document.createElement("span"),o=document.createTextNode(e);a.className="number",a.appendChild(o),s.appendChild(a);{var l=document.createElement("div"),c=document.createElement("span"),u=(document.createTextNode("Username: "),document.createElement("span")),i=document.createTextNode("Message: "),m=document.createElement("span"),r=document.createElement("span");document.createTextNode(t),document.createTextNode(n)}c.appendChild(usernametitleText),u.appendChild(i),l.appendChild(c),l.appendChild(m),l.appendChild(u),l.appendChild(r)},lastTenFunc=function(e){if(null!==e){for(var t=0;t<e.length;t++)lastTen.push(e[t]);lastTen.length>10&&(lastTen.pop(),list.removeChild(list.lastChild));for(var n=0;n<lastTen.length;n++)sectionFactory(lastTen[n],lastTen[n].username,lastTen[n].message)}},notify=function(e){if(null!==e&&queue.push(e),!playing){playing=!0;var t="http://text-to-speech-demo.mybluemix.net/synthesize?voice=en-US_AllisonVoice&text=",n=queue[0].message;messageEl.textContent=queue[0].message,usernameEl.textContent=queue[0].username,setTimeout(function(){$(".tts").attr("src",t+encodeURIComponent(n))},2e3),queue.shift(),container.classList.add("visible"),setTimeout(function(){container.classList.remove("visible"),setTimeout(function(){playing=!1,queue.length>0&&notify(null)},3e3)},displayTime)}};socket.on("subMsg",lastTen),socket.on("subMsg",notify),socket.on("stopSound",function(){$(".tts").attr("src","")});